(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[219],{4960:function(){},6759:function(){},6272:function(){},4357:function(e,t,r){Promise.resolve().then(r.bind(r,7945)),Promise.resolve().then(r.t.bind(r,2972,23))},7945:function(e,t,r){"use strict";r.d(t,{default:function(){return s}});var l=r(7437),a=r(2265),n=r(4603);function s(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),[r,s]=(0,a.useState)("select"),[i,c]=(0,a.useState)(!1),[o,d]=(0,a.useState)("#000000"),[u,g]=(0,a.useState)(5),[m,h]=(0,a.useState)(!1),[b,f]=(0,a.useState)(30);(0,a.useEffect)(()=>{if(e.current&&!t.current){let r=new n.fabric.Canvas(e.current,{width:800,height:600,backgroundColor:"#ffffff",preserveObjectStacking:!0});t.current=r;let l=()=>{let e=r.getElement().parentElement;if(e){let t=e.clientWidth,l=.6*window.innerHeight;r.setDimensions({width:t,height:l}),r.renderAll()}};return l(),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l),r.dispose(),t.current=null}}},[]),(0,a.useEffect)(()=>{let e=t.current;if(e)switch(e.isDrawingMode=!1,e.selection=!0,r){case"draw":e.isDrawingMode=!0;let l=e.freeDrawingBrush;l.color=o,l.width=u;break;case"select":e.selection=!0}},[r,o,u]);let p=e=>{var r;let l=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!l)return;let a=new FileReader;a.onload=e=>{var r;let l=null===(r=e.target)||void 0===r?void 0:r.result;n.fabric.Image.fromURL(l,e=>{let r=t.current;if(!r)return;r.clear();let l=r.getWidth(),a=r.getHeight();if(e.width&&e.height){let t=.9*Math.min(l/e.width,a/e.height);e.scale(t)}r.centerObject(e),r.add(e),c(!0),r.renderAll()})},a.readAsDataURL(l)},x=()=>{let e=t.current;if(!e)return;let r=new n.fabric.IText("Double click to edit",{left:e.getWidth()/2,top:e.getHeight()/2,fontFamily:"Arial",fill:o,fontSize:20,originX:"center",originY:"center"});e.add(r),e.setActiveObject(r),e.renderAll()},j=e=>{let r;let l=t.current;l&&(r="rect"===e?new n.fabric.Rect({left:l.getWidth()/2,top:l.getHeight()/2,width:100,height:100,fill:o,originX:"center",originY:"center"}):new n.fabric.Circle({left:l.getWidth()/2,top:l.getHeight()/2,radius:50,fill:o,originX:"center",originY:"center"}),l.add(r),l.setActiveObject(r),l.renderAll())},v=()=>{let e=t.current;if(!e)return;let r=e.toDataURL({format:"png",quality:1}),l=document.createElement("a");l.download="image-editor-export.png",l.href=r,l.click()};return(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"card flex-grow order-2 lg:order-1",children:[(0,l.jsxs)("div",{className:"relative rounded-lg border border-gray-300 overflow-hidden bg-gray-100 mb-4",children:[(0,l.jsx)("canvas",{ref:e,className:"block w-full"}),!i&&(0,l.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-500",children:[(0,l.jsx)("p",{className:"mb-4",children:"No image loaded"}),(0,l.jsxs)("label",{className:"btn btn-primary cursor-pointer",children:["Upload Image",(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:p})]})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"btn btn-secondary text-sm px-3",onClick:()=>v(),children:"Export"}),(0,l.jsx)("button",{className:"btn btn-secondary text-sm px-3",onClick:()=>{let e=t.current;if(!e)return;let r=e.getActiveObjects();r.length&&(r.forEach(t=>e.remove(t)),e.discardActiveObject(),e.renderAll(),0===e.getObjects().length&&c(!1))},children:"Delete Selected"})]}):(0,l.jsxs)("label",{className:"btn btn-primary text-sm px-3 cursor-pointer",children:["Import",(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:p,title:"Import image","aria-label":"Import image"})]})})]}),(0,l.jsxs)("div",{className:"card w-full lg:w-64 shrink-0 order-1 lg:order-2",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-3",children:"Tools"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,l.jsx)("button",{className:"btn p-2 ".concat("select"===r?"btn-primary":"btn-secondary"),onClick:()=>s("select"),children:"Select"}),(0,l.jsx)("button",{className:"btn p-2 ".concat("draw"===r?"btn-primary":"btn-secondary"),onClick:()=>s("draw"),children:"Draw"}),(0,l.jsx)("button",{className:"btn p-2 btn-secondary",onClick:()=>x(),children:"Text"}),(0,l.jsx)("button",{className:"btn p-2 btn-secondary",onClick:()=>j("rect"),children:"Rectangle"}),(0,l.jsx)("button",{className:"btn p-2 btn-secondary",onClick:()=>j("circle"),children:"Circle"}),(0,l.jsxs)("label",{className:"btn p-2 btn-secondary cursor-pointer",children:["Image",(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:p})]}),(0,l.jsx)("button",{className:"btn p-2 btn-secondary col-span-3 ".concat(m?"opacity-50 cursor-not-allowed":""),onClick:()=>{h(!0);let e=t.current;if(!e){h(!1);return}let r=e.getObjects().find(e=>"image"===e.type);if(!r){h(!1),alert("Please upload an image first.");return}try{let t=document.createElement("canvas"),l=t.getContext("2d");if(!l){h(!1);return}let a=r.getElement();t.width=a.width,t.height=a.height,l.drawImage(a,0,0);let s=l.getImageData(0,0,t.width,t.height),i=s.data,c=i[0],o=i[1],d=i[2];for(let e=0;e<i.length;e+=4){let t=i[e],r=i[e+1],l=i[e+2];Math.sqrt((t-c)*(t-c)+(r-o)*(r-o)+(l-d)*(l-d))<b&&(i[e+3]=0)}l.putImageData(s,0,0),n.fabric.Image.fromURL(t.toDataURL(),t=>{e.remove(r),r.scaleX&&r.scaleY&&t.set({left:r.left,top:r.top,scaleX:r.scaleX,scaleY:r.scaleY,angle:r.angle,originX:r.originX,originY:r.originY}),e.add(t),e.renderAll(),h(!1)})}catch(e){console.error("Error removing background:",e),h(!1)}},disabled:m,children:m?"Processing...":"Remove Background"})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-3",children:"Properties"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Color"}),(0,l.jsx)("input",{type:"color",value:o,onChange:e=>d(e.target.value),className:"w-full rounded border border-gray-300 h-8",title:"Color picker","aria-label":"Select color"})]}),"draw"===r&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm mb-1",children:["Brush Size: ",u,"px"]}),(0,l.jsx)("input",{type:"range",min:"1",max:"50",value:u,onChange:e=>g(parseInt(e.target.value)),className:"w-full",title:"Brush size slider","aria-label":"Adjust brush size"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm mb-1",children:["Background Tolerance: ",b]}),(0,l.jsx)("input",{type:"range",min:"5",max:"100",value:b,onChange:e=>f(parseInt(e.target.value)),className:"w-full",title:"Background tolerance slider","aria-label":"Adjust background removal tolerance"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Higher values remove more of the background"})]})]})]})]})]})}}},function(e){e.O(0,[789,972,434,971,117,744],function(){return e(e.s=4357)}),_N_E=e.O()}]);